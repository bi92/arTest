<html>
  <head>
     <title>Elle AR</title>
    <meta name="viewport" content="width=device-width, initial-scale=1"  />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <script src="https://cdn.jsdelivr.net/gh/hiukim/mind-ar-js@1.0.0/dist/mindar-image.prod.js"></script>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/hiukim/mind-ar-js@1.0.0/dist/mindar-image-aframe.prod.js"></script>
  

  <script>
    
   
    window.onload = function() {
   
    const sceneEl = document.querySelector('a-scene');
    const arSystem = sceneEl.systems["mindar-image-system"];
    const scene = document.querySelector("a-scene");
      
      
     document.addEventListener("DOMContentLoaded", function(event) {
    const vid = document.getElementById("frontVideo");
    if (scene.hasLoaded) {
      run();
    } else {
      scene.addEventListener("loaded", run);
    }

    function run () {
      if(AFRAME.utils.device.isMobile()) {
        document.querySelector('#splash').style.display = 'flex';
        document.querySelector('#splash').addEventListener('click', function () {
          playVideo();
          this.style.display = 'none';
        })
      } else {
          playVideo();
      }
    }

    function playVideo () {
      vid.play();
    }
  })
      
  
    
    // arReady event triggered when ready
    sceneEl.addEventListener("arReady", (event) => {
       console.log("MindAR is ready")
    });
      
  var frontVid = document.getElementById("frontVideo");
    // detect target found
     const exampleTarget = document.querySelector('#frontAR');
      exampleTarget.addEventListener("targetFound", event => {
        console.log("target found frontAR");
          frontVid.play();
      });

      // detect target lost
      exampleTarget.addEventListener("targetLost", event => {
        console.log("target lost frontAR");
          //frontVid.stop();
      });
      
  const VRButton = document.querySelector('#start-button');
    VRButton.addEventListener("click",event =>{
        video.play();
         console.log("target lost frontAR");
    });
        
 }


     
    </script>
  </head>
       
  <body>  
      <div id="start-button">Start
       </div>
   
    
    <a-scene mindar-image="imageTargetSrc: https://cdn.glitch.me/5b541583-3518-4762-aa17-c544a070bbb6%2Ftarget_front_whole.mind?v=1636601140073; maxTrack: 2" 
             color-space="sRGB" renderer="colorManagement: true, physicallyCorrectLights" vr-mode-ui="enabled: false" renderer="logarithmicDepthBuffer: false" 
             device-orientation-permission-ui="enabled: false">
      <a-assets>
         
        <video id="frontVideo"  src="https://cdn.glitch.me/5b541583-3518-4762-aa17-c544a070bbb6%2Ffront_video_l.mp4?v=1636859950771"  width="1" height="1"  autoplay muted loop  playsinline></a-video>
         <video id="backVideo"  src="https://cdn.glitch.me/5b541583-3518-4762-aa17-c544a070bbb6%2Fback_bazza.mp4?v=1636872813680"  width="1" height="1"  autoplay = "true" muted loop  playsinline></a-video>
       
      </a-assets>

      <a-camera position="0 0 0" look-controls="enabled: false"  far="100000"></a-camera>
     
            
      <a-entity id ="backAR"  mindar-image-target="targetIndex: 1">
       <a-video rotation="0 0 0 " position="0 0 0" scale="1 0.514 1" src="#backVideo" loop="true" ></a-video>
      </a-entity>
    
     <a-entity id ="frontAR" mindar-image-target="targetIndex: 0">
        <a-video rotation="0 0 0 " position="0 0 0" scale="1 0.514 1" src="#frontVideo" loop="true" ></a-video>
      </a-entity>
        
      
  
    </a-scene>
  </body>
</html>
    
    